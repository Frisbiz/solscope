<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SolScope ‚Äî Solana Wallet Intelligence</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:wght@300;400;500;600&display=swap');

  :root {
    --bg:#080b10; --surface:#0d1117; --surf2:#131922; --border:#1c2333; --border2:#243045;
    --accent:#9945ff; --green:#14f195; --red:#f05c5c; --yellow:#ffd166; --orange:#f4845f; --blue:#60a5fa;
    --text:#e2e8f0; --muted:#7a8a9e; --dim:#3d4f63;
    --mono:'Space Mono',monospace; --sans:'DM Sans',sans-serif; --r:8px;
  }
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
  body{background:var(--bg);color:var(--text);font-family:var(--sans);min-height:100vh;overflow-x:hidden;}
  body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
    background:radial-gradient(ellipse 60% 40% at 80% 10%,rgba(153,69,255,.07) 0%,transparent 60%),
               radial-gradient(ellipse 40% 30% at 10% 80%,rgba(20,241,149,.04) 0%,transparent 50%);}
  .wrap{max-width:1400px;margin:0 auto;padding:0 24px;position:relative;z-index:1;}

  /* HEADER */
  header{border-bottom:1px solid var(--border);padding:0;position:sticky;top:0;background:rgba(8,11,16,.95);backdrop-filter:blur(16px);z-index:100;}
  .header-inner{display:flex;align-items:center;justify-content:space-between;gap:12px;height:56px;}
  .logo{font-family:var(--mono);font-size:15px;display:flex;align-items:center;gap:10px;text-decoration:none;}
  .logo-icon{width:30px;height:30px;flex-shrink:0;background:linear-gradient(135deg,var(--accent),var(--green));border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:15px;}
  .logo-text{color:var(--text);} .logo-text em{color:var(--green);font-style:normal;}
  .header-right{display:flex;align-items:center;gap:8px;}
  .status-pill{font-family:var(--mono);font-size:10px;padding:4px 10px;border-radius:20px;border:1px solid var(--border2);color:var(--dim);background:var(--surf2);}
  .status-pill.running{border-color:var(--accent);color:var(--accent);background:rgba(153,69,255,.08);}
  .status-pill.done{border-color:var(--green);color:var(--green);background:rgba(20,241,149,.08);}
  .status-pill.error{border-color:var(--red);color:var(--red);background:rgba(240,92,92,.08);}

  /* BUTTONS */
  .btn{border:none;border-radius:6px;padding:8px 16px;font-family:var(--sans);font-size:13px;font-weight:600;cursor:pointer;transition:all .15s;white-space:nowrap;display:inline-flex;align-items:center;gap:6px;}
  .btn-primary{background:var(--accent);color:#fff;} .btn-primary:hover{background:#8535e6;} .btn-primary:disabled{opacity:.5;cursor:not-allowed;}
  .btn-ghost{background:transparent;border:1px solid var(--border2);color:var(--muted);} .btn-ghost:hover{border-color:var(--accent);color:var(--accent);}
  .btn-teal{background:rgba(20,241,149,.1);border:1px solid rgba(20,241,149,.25);color:var(--green);} .btn-teal:hover{background:rgba(20,241,149,.2);}
  .btn-sm{padding:5px 10px;font-size:11px;}

  main{padding:24px 0 60px;}

  /* STATS */
  .stats-row{display:grid;grid-template-columns:repeat(6,1fr);gap:10px;margin-bottom:20px;}
  @media(max-width:900px){.stats-row{grid-template-columns:repeat(3,1fr);}}
  .stat{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:14px 16px;position:relative;overflow:hidden;}
  .stat::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;border-radius:3px 0 0 3px;}
  .stat.c-purple::before{background:var(--accent);} .stat.c-green::before{background:var(--green);}
  .stat.c-blue::before{background:var(--blue);}     .stat.c-yellow::before{background:var(--yellow);}
  .stat.c-orange::before{background:var(--orange);}
  .stat-label{font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--muted);font-family:var(--mono);margin-bottom:6px;}
  .stat-val{font-size:20px;font-weight:700;font-family:var(--mono);}
  .cv-purple{color:var(--accent);} .cv-green{color:var(--green);} .cv-blue{color:var(--blue);}
  .cv-yellow{color:var(--yellow);} .cv-orange{color:var(--orange);} .cv-red{color:var(--red);}

  /* TABS */
  .tabs{display:flex;gap:2px;margin-bottom:20px;background:var(--surf2);border:1px solid var(--border);border-radius:var(--r);padding:4px;width:fit-content;}
  .tab{font-family:var(--mono);font-size:11px;padding:7px 18px;border-radius:6px;border:none;background:transparent;color:var(--muted);cursor:pointer;transition:all .15s;white-space:nowrap;display:flex;align-items:center;gap:7px;}
  .tab:hover{color:var(--text);}
  .tab.active{background:var(--surface);color:var(--text);border:1px solid var(--border2);box-shadow:0 1px 4px rgba(0,0,0,.3);}
  .tab-pane{display:none;} .tab-pane.active{display:block;}
  .tab-badge{background:rgba(153,69,255,.15);border:1px solid rgba(153,69,255,.2);color:var(--accent);border-radius:10px;font-size:9px;padding:1px 6px;}
  .tab-badge.orange{background:rgba(244,132,95,.12);border-color:rgba(244,132,95,.25);color:var(--orange);}
  .tab-badge.blue{background:rgba(96,165,250,.12);border-color:rgba(96,165,250,.25);color:var(--blue);}

  /* INPUTS */
  .fi{background:var(--surf2);border:1px solid var(--border);border-radius:5px;color:var(--text);font-size:11px;padding:5px 9px;outline:none;font-family:var(--mono);transition:border-color .2s;}
  .fi::placeholder{color:var(--dim);} .fi:focus{border-color:var(--accent);box-shadow:0 0 0 2px rgba(153,69,255,.1);}
  .fi-xs{width:52px;} .fi-sm{width:70px;} .fi-md{width:90px;} .fi-lg{width:200px;}
  .sel{background:var(--surf2);border:1px solid var(--border);border-radius:5px;color:var(--muted);font-size:11px;padding:5px 9px;outline:none;cursor:pointer;font-family:var(--mono);transition:border-color .2s;}
  .sel:focus{border-color:var(--accent);}

  /* SCRAPE CONFIG */
  .scrape-config{display:flex;align-items:center;gap:10px;flex-wrap:wrap;background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:12px 16px;margin-bottom:12px;}
  .cfg-label{font-size:9px;text-transform:uppercase;letter-spacing:1.2px;color:var(--dim);font-family:var(--mono);font-weight:700;}
  .cfg-sep{width:1px;height:20px;background:var(--border2);margin:0 4px;flex-shrink:0;}
  .cb-label{display:flex;align-items:center;gap:5px;font-size:12px;color:var(--text);cursor:pointer;user-select:none;font-family:var(--mono);}
  .cb-label input[type=checkbox]{accent-color:var(--accent);width:13px;height:13px;cursor:pointer;}

  /* CA PANEL */
  .ca-panel{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:16px 18px;margin-bottom:12px;}
  .ca-panel-title{font-family:var(--mono);font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:12px;}
  .ca-row{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:8px;}
  .ca-input{flex:1;min-width:280px;max-width:500px;background:var(--surf2);border:1px solid var(--border2);border-radius:6px;color:var(--text);font-family:var(--mono);font-size:12px;padding:9px 14px;outline:none;transition:border-color .2s;}
  .ca-input:focus{border-color:var(--accent);box-shadow:0 0 0 2px rgba(153,69,255,.1);} .ca-input::placeholder{color:var(--dim);}
  .ca-hint{font-size:11px;color:var(--dim);font-family:var(--mono);}
  .ca-banner{display:none;background:rgba(20,241,149,.05);border:1px solid rgba(20,241,149,.15);border-radius:6px;padding:10px 14px;margin-top:10px;font-family:var(--mono);font-size:11px;color:var(--green);}
  .ca-banner.err{background:rgba(240,92,92,.05);border-color:rgba(240,92,92,.15);color:var(--red);}

  /* TRENDING NOTICE */
  .trending-notice{display:flex;align-items:flex-start;gap:10px;background:rgba(244,132,95,.06);border:1px solid rgba(244,132,95,.2);border-radius:var(--r);padding:12px 16px;margin-bottom:14px;}
  .tn-icon{font-size:16px;flex-shrink:0;margin-top:1px;}
  .tn-text{font-size:12px;color:var(--muted);line-height:1.6;}
  .tn-text strong{color:var(--orange);}

  /* LOG */
  .log-panel{display:none;background:#060a0f;border:1px solid var(--border);border-radius:var(--r);padding:12px 14px;font-family:var(--mono);font-size:11px;line-height:1.7;max-height:180px;overflow-y:auto;margin-bottom:12px;scrollbar-width:thin;scrollbar-color:var(--border2) transparent;}
  .log-line{color:var(--muted);} .log-line.ok{color:var(--green);} .log-line.err{color:var(--red);} .log-line.inf{color:var(--blue);}
  .progress-bar-wrap{display:none;height:3px;background:var(--border);border-radius:2px;margin-bottom:14px;overflow:hidden;}
  .progress-bar-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--green));border-radius:2px;transition:width .3s;}

  /* TOOLBAR */
  .toolbar{display:flex;align-items:center;gap:8px;margin-bottom:10px;flex-wrap:wrap;}
  .tb-sep{width:1px;height:22px;background:var(--border2);margin:0 2px;flex-shrink:0;}
  .tb-lbl{font-size:9px;color:var(--dim);font-family:var(--mono);text-transform:uppercase;letter-spacing:1px;white-space:nowrap;}
  .sort-btn{background:var(--surface);border:1px solid var(--border);border-radius:5px;color:var(--muted);font-size:11px;padding:5px 11px;cursor:pointer;display:flex;align-items:center;gap:4px;transition:all .12s;font-family:var(--mono);white-space:nowrap;user-select:none;}
  .sort-btn:hover{border-color:var(--accent);color:var(--text);} .sort-btn.active{border-color:var(--accent);color:var(--accent);background:rgba(153,69,255,.08);}
  .filter-toggle{display:flex;align-items:center;gap:6px;background:var(--surface);border:1px solid var(--border);border-radius:5px;color:var(--muted);font-size:11px;padding:5px 11px;cursor:pointer;font-family:var(--mono);white-space:nowrap;transition:all .12s;}
  .filter-toggle:hover,.filter-toggle.on{border-color:var(--accent);color:var(--accent);background:rgba(153,69,255,.08);}
  .filter-dot{color:var(--accent);font-size:8px;display:none;} .filter-dot.on{display:inline;}
  .count-badge{background:rgba(153,69,255,.1);border:1px solid rgba(153,69,255,.2);border-radius:20px;padding:3px 12px;font-family:var(--mono);font-size:11px;color:var(--accent);margin-left:auto;}

  /* FILTER PANEL */
  .filter-panel{display:none;background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:16px 18px;margin-bottom:12px;animation:fadeIn .15s ease;}
  .filter-panel.open{display:block;}
  @keyframes fadeIn{from{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:none}}
  .filter-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:14px;}
  @media(max-width:900px){.filter-grid{grid-template-columns:repeat(2,1fr);}}
  .fg-title{font-size:9px;text-transform:uppercase;letter-spacing:1.2px;color:var(--muted);font-family:var(--mono);font-weight:700;margin-bottom:10px;}
  .fg-row{display:flex;align-items:center;gap:6px;margin-bottom:6px;}
  .fg-lbl{font-size:10px;color:var(--dim);font-family:var(--mono);width:30px;flex-shrink:0;}
  .filter-footer{display:flex;align-items:center;gap:10px;padding-top:10px;border-top:1px solid var(--border);}
  .filter-summary{font-size:11px;color:var(--muted);font-family:var(--mono);flex:1;}

  /* TABLE */
  .table-wrap{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;}
  .col-sm  {grid-template-columns:44px 1fr 90px 130px 140px 130px 80px 110px 130px;}
  .col-tr  {grid-template-columns:44px 1fr 110px 220px 130px;}
  .thead{display:grid;background:var(--surf2);border-bottom:1px solid var(--border);}
  .th{font-family:var(--mono);font-size:9px;text-transform:uppercase;letter-spacing:1px;color:var(--dim);padding:11px 12px;cursor:pointer;user-select:none;display:flex;align-items:center;gap:3px;transition:color .12s;border-right:1px solid var(--border);white-space:nowrap;}
  .th:last-child{border-right:none;} .th:hover{color:var(--muted);} .th.sorted{color:var(--accent);}
  .th.ns{cursor:default;} .th.ns:hover{color:var(--dim);}
  .t-body{overflow-y:auto;max-height:calc(100vh - 340px);min-height:260px;}
  .wrow{display:grid;border-bottom:1px solid var(--border);transition:background .08s;}
  .wrow:last-child{border-bottom:none;} .wrow:hover{background:rgba(153,69,255,.04);}
  .td{padding:10px 12px;font-size:12px;border-right:1px solid var(--border);display:flex;align-items:center;overflow:hidden;}
  .td:last-child{border-right:none;}
  .td-num{color:var(--dim);font-family:var(--mono);font-size:11px;}
  .w-info{flex-direction:column;align-items:flex-start;gap:3px;}
  .w-addr{font-family:var(--mono);font-size:11px;color:var(--green);cursor:pointer;transition:color .1s;}
  .w-addr:hover{color:#fff;}
  .w-meta{display:flex;align-items:center;gap:5px;}
  .w-lbl{font-size:10px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:160px;}
  .src-badge{font-size:9px;padding:1px 5px;border-radius:3px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;flex-shrink:0;}
  .src-gmgn    {background:rgba(20,241,149,.1); color:var(--green);  border:1px solid rgba(20,241,149,.2);}
  .src-trending{background:rgba(244,132,95,.1); color:var(--orange); border:1px solid rgba(244,132,95,.2);}
  .src-ca      {background:rgba(96,165,250,.1); color:var(--blue);   border:1px solid rgba(96,165,250,.2);}
  .tag{display:inline-block;font-family:var(--mono);font-size:9px;padding:2px 7px;border-radius:3px;font-weight:700;letter-spacing:.3px;white-space:nowrap;}
  .t-whale{background:rgba(255,209,102,.12);border:1px solid rgba(255,209,102,.25);color:var(--yellow);}
  .t-bot  {background:rgba(20,241,149,.12); border:1px solid rgba(20,241,149,.25); color:var(--green);}
  .t-smart{background:rgba(153,69,255,.12); border:1px solid rgba(153,69,255,.25); color:var(--accent);}
  .pnl-p{color:var(--green);font-family:var(--mono);font-size:12px;font-weight:700;}
  .pnl-n{color:var(--red);  font-family:var(--mono);font-size:12px;font-weight:700;}
  .wr-wrap{flex-direction:column;align-items:flex-start;gap:4px;}
  .wr-pct{font-family:var(--mono);font-size:12px;font-weight:700;}
  .wr-bar{width:80px;height:3px;border-radius:2px;background:var(--border2);overflow:hidden;}
  .wr-fill{height:100%;border-radius:2px;}
  .hold-wrap{flex-direction:column;align-items:flex-start;gap:1px;}
  .hold-v{font-family:var(--mono);font-size:13px;} .hold-u{font-size:10px;color:var(--dim);}
  .trd{font-family:var(--mono);font-size:12px;color:var(--muted);}
  .acts{display:flex;align-items:center;gap:6px;flex-wrap:nowrap;}
  .btn-view{display:inline-flex;align-items:center;gap:3px;padding:4px 8px;border-radius:4px;font-size:10px;font-weight:700;background:rgba(20,241,149,.1);color:var(--green);border:1px solid rgba(20,241,149,.25);text-decoration:none;white-space:nowrap;font-family:var(--mono);transition:background .15s;letter-spacing:.3px;}
  .btn-view:hover{background:rgba(20,241,149,.22);}
  .btn-del{display:inline-flex;align-items:center;background:transparent;border:1px solid rgba(240,92,92,.25);color:var(--red);font-size:13px;line-height:1;padding:3px 7px;border-radius:4px;cursor:pointer;transition:all .12s;flex-shrink:0;}
  .btn-del:hover{background:rgba(240,92,92,.12);}

  /* EMPTY */
  .empty{text-align:center;padding:60px 20px;}
  .empty-icon{font-size:28px;margin-bottom:10px;color:var(--dim);}
  .empty-text{font-family:var(--mono);font-size:12px;color:var(--dim);line-height:2;}

  /* TOAST */
  .toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(20px);background:var(--surf2);border:1px solid var(--border2);color:var(--text);font-family:var(--mono);font-size:12px;padding:10px 20px;border-radius:20px;opacity:0;transition:all .25s;pointer-events:none;white-space:nowrap;z-index:999;}
  .toast.show{opacity:1;transform:translateX(-50%) translateY(0);}

  /* PERIOD TOGGLE */
  .period-toggle{display:flex;gap:2px;background:var(--surf2);border:1px solid var(--border);border-radius:6px;padding:2px;}
  .period-btn{font-family:var(--mono);font-size:10px;padding:4px 10px;border-radius:4px;border:none;background:transparent;color:var(--muted);cursor:pointer;transition:all .12s;white-space:nowrap;}
  .period-btn:hover{color:var(--text);}
  .period-btn.active{background:var(--surface);color:var(--accent);border:1px solid var(--border2);}

  @keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
  @keyframes spin{to{transform:rotate(360deg)}}
  .spinning{display:inline-block;animation:spin 1s linear infinite;}
</style>
</head>
<body>

<header>
  <div class="wrap">
    <div class="header-inner">
      <a class="logo" href="#">
        <div class="logo-icon">‚óé</div>
        <span class="logo-text">Sol<em>Scope</em></span>
      </a>
      <div class="header-right">
        <span class="status-pill" id="statusPill">‚óé Idle</span>
        <button class="btn btn-primary" id="scrapeBtn" onclick="startScrape()">‚ñ∂ Auto-Discover</button>
      </div>
    </div>
  </div>
</header>

<main>
<div class="wrap">

  <!-- Stats (smart money only ‚Äî trending & CA never affect this) -->
  <div class="stats-row">
    <div class="stat c-purple"><div class="stat-label">Wallets Tracked</div><div class="stat-val cv-purple" id="s-count">0</div></div>
    <div class="stat c-green"> <div class="stat-label">Avg Win Rate</div>  <div class="stat-val cv-green"  id="s-wr">‚Äî</div></div>
    <div class="stat c-green"> <div class="stat-label">Total PnL</div>     <div class="stat-val"            id="s-pnl">‚Äî</div></div>
    <div class="stat c-blue">  <div class="stat-label">Avg Hold Time</div> <div class="stat-val cv-blue"    id="s-hold">‚Äî</div></div>
    <div class="stat c-yellow"><div class="stat-label">Profitable</div>    <div class="stat-val cv-yellow"  id="s-prof">‚Äî</div></div>
    <div class="stat c-orange"><div class="stat-label">Shown / Total</div> <div class="stat-val cv-orange"  id="s-shown">‚Äî</div></div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab active" onclick="switchTab('smart')"    id="tab-smart">üß† Smart Money <span class="tab-badge" id="tb-smart">0</span></button>
    <button class="tab"        onclick="switchTab('trending')" id="tab-trending">üî• Trending <span class="tab-badge orange" id="tb-trending">0</span></button>
    <button class="tab"        onclick="switchTab('ca')"       id="tab-ca">üîç CA Lookup <span class="tab-badge blue" id="tb-ca">0</span></button>
  </div>

  <!-- Shared log + progress -->
  <div class="log-panel" id="logPanel"></div>
  <div class="progress-bar-wrap" id="progressWrap"><div class="progress-bar-fill" id="progressFill" style="width:0%"></div></div>

  <!-- ‚ïê‚ïê SMART MONEY ‚ïê‚ïê -->
  <div class="tab-pane active" id="pane-smart">
    <div class="scrape-config">
      <span class="cfg-label">Period</span>
      <div class="period-toggle">
        <button class="period-btn" id="smP-1d"  onclick="setSmartPeriod('1d')">1D</button>
        <button class="period-btn active" id="smP-7d"  onclick="setSmartPeriod('7d')">7D</button>
        <button class="period-btn" id="smP-30d" onclick="setSmartPeriod('30d')">30D</button>
      </div>
      <div class="cfg-sep"></div>
      <span class="cfg-label">Sources</span>
      <label class="cb-label"><input type="checkbox" id="cfgGmgn" checked> GMGN Leaderboards</label>
      <label class="cb-label"><input type="checkbox" id="cfgTrending" checked> Trending Buyers</label>
      <div class="cfg-sep"></div>
      <span class="cfg-label">Min Threshold</span>
      <span style="font-size:11px;color:var(--muted)">WR</span>
      <input class="fi fi-xs" id="cfgMinWr" value="0" />
      <span style="font-size:11px;color:var(--dim)">%</span>
      <span style="font-size:11px;color:var(--muted)">PnL $</span>
      <input class="fi fi-sm" id="cfgMinPnl" value="0" />
      <span style="font-size:11px;color:var(--muted)">Trades</span>
      <input class="fi fi-xs" id="cfgMinTrades" value="5" />
    </div>

    <div class="toolbar">
      <span class="tb-lbl">Sort</span>
      <button class="sort-btn active" id="sb-pnl"      onclick="setSort('pnl')">PnL <span id="a-pnl">‚Üì</span></button>
      <button class="sort-btn"        id="sb-winrate"  onclick="setSort('winrate')">Win Rate <span id="a-wr">‚Üì</span></button>
      <button class="sort-btn"        id="sb-holdtime" onclick="setSort('holdtime')">Hold Time <span id="a-ht">‚Üì</span></button>
      <button class="sort-btn"        id="sb-trades"   onclick="setSort('trades')">Trades <span id="a-tr">‚Üì</span></button>
      <div class="tb-sep"></div>
      <input class="fi fi-lg" id="fSearch" placeholder="search address or label‚Ä¶" oninput="applyFilters()" />
      <select class="sel" id="fTag" onchange="applyFilters()">
        <option value="">All Tags</option>
        <option value="whale">üêã Whale</option>
        <option value="smart">üß† Smart</option>
        <option value="bot">ü§ñ Bot</option>
      </select>
      <div class="tb-sep"></div>
      <button class="filter-toggle" id="filterBtn" onclick="toggleFilters()">‚öô Filters <span class="filter-dot" id="filterDot">‚óè</span></button>
      <span class="count-badge" id="cBadge">0 wallets</span>
      <button class="btn btn-ghost btn-sm" onclick="clearAll()">Clear All</button>
    </div>

    <div class="filter-panel" id="filterPanel">
      <div class="filter-grid">
        <div>
          <div class="fg-title">üí∞ PnL (USD)</div>
          <div class="fg-row"><span class="fg-lbl">Min $</span><input class="fi fi-sm" id="fPnlMin" placeholder="e.g. 500" oninput="applyFilters()" /></div>
          <div class="fg-row"><span class="fg-lbl">Max $</span><input class="fi fi-sm" id="fPnlMax" placeholder="no limit" oninput="applyFilters()" /></div>
        </div>
        <div>
          <div class="fg-title">üéØ Win Rate</div>
          <div class="fg-row"><span class="fg-lbl">Min %</span><input class="fi fi-sm" id="fWrMin" placeholder="e.g. 50" oninput="applyFilters()" /></div>
          <div class="fg-row"><span class="fg-lbl">Max %</span><input class="fi fi-sm" id="fWrMax" placeholder="no limit" oninput="applyFilters()" /></div>
        </div>
        <div>
          <div class="fg-title">‚è± Hold Time (mins)</div>
          <div class="fg-row"><span class="fg-lbl">Min</span><input class="fi fi-sm" id="fHoldMin" placeholder="e.g. 30" oninput="applyFilters()" /></div>
          <div class="fg-row"><span class="fg-lbl">Max</span><input class="fi fi-sm" id="fHoldMax" placeholder="no limit" oninput="applyFilters()" /></div>
        </div>
        <div>
          <div class="fg-title">üîÅ Trades</div>
          <div class="fg-row"><span class="fg-lbl">Min</span><input class="fi fi-sm" id="fTradesMin" placeholder="e.g. 10" oninput="applyFilters()" /></div>
          <div class="fg-row"><span class="fg-lbl">Max</span><input class="fi fi-sm" id="fTradesMax" placeholder="no limit" oninput="applyFilters()" /></div>
        </div>
      </div>
      <div class="filter-footer">
        <button class="btn btn-ghost btn-sm" onclick="resetFilters()">Reset All</button>
        <span class="filter-summary" id="filterSummary"></span>
      </div>
    </div>

    <div class="table-wrap">
      <div class="thead col-sm">
        <div class="th ns">#</div>
        <div class="th ns">Wallet</div>
        <div class="th ns">Tag</div>
        <div class="th sorted" id="th-pnl"      onclick="setSort('pnl')">PnL <span id="smPeriodLabel" style="color:var(--dim);font-size:8px"></span> <span id="ta-pnl">‚Üì</span></div>
        <div class="th"         id="th-winrate"  onclick="setSort('winrate')">Win Rate <span id="ta-wr">‚Üì</span></div>
        <div class="th"         id="th-holdtime" onclick="setSort('holdtime')">Avg Hold <span id="ta-ht">‚Üì</span></div>
        <div class="th"         id="th-trades"   onclick="setSort('trades')">Trades <span id="ta-tr">‚Üì</span></div>
        <div class="th ns">Last Active</div>
        <div class="th ns">Actions</div>
      </div>
      <div class="t-body" id="tableBody"></div>
      <div class="empty" id="emptyMsg">
        <div class="empty-icon">‚óé</div>
        <div class="empty-text">No wallets yet.<br>Hit <b style="color:var(--green)">‚ñ∂ Auto-Discover</b> to start.</div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê TRENDING ‚ïê‚ïê -->
  <div class="tab-pane" id="pane-trending">
    <div class="trending-notice">
      <div class="tn-icon">‚ö†Ô∏è</div>
      <div class="tn-text">
        <strong>Addresses only ‚Äî no stats.</strong> GMGN's trending buyer endpoint returns wallet addresses and tags but no PnL, win rate, or hold time. Kept here separately so Smart Money stats stay accurate. Click GMGN ‚Üó to view any wallet's full profile.
      </div>
    </div>
    <div class="toolbar">
      <input class="fi fi-lg" id="tSearch" placeholder="search address‚Ä¶" oninput="renderTrending()" />
      <span class="count-badge" id="tBadge">0 wallets</span>
      <button class="btn btn-ghost btn-sm" onclick="clearTrending()">Clear</button>
    </div>
    <div class="table-wrap">
      <div class="thead col-tr">
        <div class="th ns">#</div>
        <div class="th ns">Wallet</div>
        <div class="th ns">From Token</div>
        <div class="th ns">GMGN Tags</div>
        <div class="th ns">Actions</div>
      </div>
      <div class="t-body" id="trendingBody"></div>
      <div class="empty" id="trendingEmpty">
        <div class="empty-icon">üî•</div>
        <div class="empty-text">No trending wallets yet.<br>Hit <b style="color:var(--green)">‚ñ∂ Auto-Discover</b> to fetch.</div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê CA LOOKUP ‚ïê‚ïê -->
  <div class="tab-pane" id="pane-ca">
    <div class="ca-panel">
      <div class="ca-panel-title">üîç Fetch wallets that traded a specific token</div>
      <div class="ca-row">
        <input class="ca-input" id="caInput" placeholder="Paste token contract address (CA)‚Ä¶" />
        <div class="period-toggle">
          <button class="period-btn" id="caP-1d"  onclick="setCAPeriod('1d')">1D</button>
          <button class="period-btn" id="caP-7d"  onclick="setCAPeriod('7d')">7D</button>
          <button class="period-btn active" id="caP-30d" onclick="setCAPeriod('30d')">30D</button>
        </div>
        <button class="btn btn-teal" id="caBtn" onclick="caLookup()">Fetch Traders</button>
        <button class="btn btn-ghost btn-sm" onclick="clearCA()">Clear</button>
      </div>
      <div class="ca-hint">Pulls top 100 buyers sorted by profit. Period controls which stats window is shown.</div>
      <div class="ca-banner" id="caBanner"></div>
    </div>
    <div class="toolbar">
      <input class="fi fi-lg" id="caSearch" placeholder="search address‚Ä¶" oninput="renderCA()" />
      <select class="sel" id="caTagF" onchange="renderCA()">
        <option value="">All Tags</option>
        <option value="whale">üêã Whale</option>
        <option value="smart">üß† Smart</option>
        <option value="bot">ü§ñ Bot</option>
      </select>
      <select class="sel" id="caStatsF" onchange="renderCA()">
        <option value="">All</option>
        <option value="yes">Has Stats</option>
        <option value="no">No Stats</option>
      </select>
      <span class="count-badge" id="caBadge">0 wallets</span>
    </div>
    <div class="table-wrap">
      <div class="thead col-sm">
        <div class="th ns">#</div>
        <div class="th ns">Wallet</div>
        <div class="th ns">Tag</div>
        <div class="th ns">Realized PnL</div>
        <div class="th ns">Win Rate</div>
        <div class="th ns">Avg Hold</div>
        <div class="th ns">Trades</div>
        <div class="th ns">Stats</div>
        <div class="th ns">Actions</div>
      </div>
      <div class="t-body" id="caBody"></div>
      <div class="empty" id="caEmpty">
        <div class="empty-icon">üîç</div>
        <div class="empty-text">Paste a CA above and hit <b style="color:var(--blue)">Fetch Traders</b>.</div>
      </div>
    </div>
  </div>

</div>
</main>
<div class="toast" id="toastEl"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SolScope  ‚Äî  three separate data stores, never mixed
//   wallets[]   ‚Üí Smart Money  (full stats, persisted)
//   trending[]  ‚Üí Trending     (addresses only, persisted)
//   caWallets[] ‚Üí CA Lookup    (per-session)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

let wallets   = [];
let trending  = [];
let caWallets = [];
let filtered  = [];
let sortField = 'pnl';
let sortAsc   = false;
let scraping  = false;
let smartPeriod = '7d';   // period used for smart money leaderboards
let caPeriod    = '30d';  // period used for CA lookup stats

// ‚îÄ‚îÄ Persist ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function save()         { try { localStorage.setItem('ss12',  JSON.stringify(wallets));  } catch(e){} }
function saveTrending() { try { localStorage.setItem('ss12t', JSON.stringify(trending)); } catch(e){} }
function load() {
  try { const d=localStorage.getItem('ss12');  if(d) wallets  = JSON.parse(d); } catch(e){}
  try { const d=localStorage.getItem('ss12t'); if(d) trending = JSON.parse(d); } catch(e){}
}
const sleep = ms => new Promise(r => setTimeout(r, ms));

// ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function switchTab(name) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
  document.getElementById('tab-'+name).classList.add('active');
  document.getElementById('pane-'+name).classList.add('active');
}

function setSmartPeriod(p) {
  smartPeriod = p;
  ['1d','7d','30d'].forEach(k => {
    document.getElementById('smP-'+k)?.classList.toggle('active', k===p);
  });
  const lbl = document.getElementById('smPeriodLabel');
  if (lbl) lbl.textContent = p.toUpperCase();
  // Swap active period data for all wallets that have multi-period data
  wallets.forEach(w => {
    const d = w._periods?.[p];
    if (d) {
      w.pnl      = d.pnl;
      w.winrate  = d.winrate;
      w.holdMins = d.holdMins;
      w.trades   = d.trades;
      w.tag = w.pnl>50000?'whale' : w.winrate>0.65?'smart' : w.trades>300?'bot' : '';
    }
  });
  save();
  applyFilters();
}

function setCAPeriod(p) {
  caPeriod = p;
  ['1d','7d','30d'].forEach(k => {
    document.getElementById('caP-'+k)?.classList.toggle('active', k===p);
  });
  // If we already have results, re-render with new period data
  if (caWallets.length) {
    // Swap in the pre-fetched period data for each wallet
    caWallets.forEach(w => {
      const d = w._periods?.[p];
      if (d) {
        w.pnl      = d.pnl;
        w.winrate  = d.winrate;
        w.holdMins = d.holdMins;
        w.trades   = d.trades;
        w.hasStats = d.pnl !== null;
        w.tag = (d.pnl??0)>50000?'whale':(d.winrate??0)>0.65?'smart':(d.trades??0)>300?'bot':'';
      }
    });
    renderCA();
  }
}

// ‚îÄ‚îÄ UI helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function log(msg, type='') {
  const p = document.getElementById('logPanel');
  p.style.display = 'block';
  const l = document.createElement('div');
  l.className = 'log-line ' + type;
  l.textContent = '[' + new Date().toLocaleTimeString() + '] ' + msg;
  p.appendChild(l); p.scrollTop = p.scrollHeight;
}
function setProgress(pct) { document.getElementById('progressWrap').style.display='block'; document.getElementById('progressFill').style.width=Math.min(100,pct)+'%'; }
function setStatus(txt, type='') { const el=document.getElementById('statusPill'); el.textContent='‚óé '+txt; el.className='status-pill '+type; }
function toast(msg) { const t=document.getElementById('toastEl'); t.textContent=msg; t.classList.add('show'); clearTimeout(t._t); t._t=setTimeout(()=>t.classList.remove('show'),2600); }
function badges() {
  document.getElementById('tb-smart').textContent    = wallets.length;
  document.getElementById('tb-trending').textContent = trending.length;
  document.getElementById('tb-ca').textContent       = caWallets.length;
}

// ‚îÄ‚îÄ Proxy ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const PROXY = window.location.hostname==='localhost' ? 'http://localhost:8080' : window.location.origin;
async function pf(url) {
  const r = await fetch(PROXY + '/proxy?' + encodeURIComponent(url));
  if (!r.ok) throw new Error('proxy ' + r.status);
  const j = await r.json();
  if (j.error) throw new Error(j.error);
  return j;
}

// ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function parsePeriodData(w, p) {
  const pnl     = parseFloat(w[`realized_profit_${p}`] ?? 0);
  const winrate = parseFloat(w[`winrate_${p}`] ?? 0);
  const holdMins= Math.round(parseFloat(w[`avg_holding_period_${p}`] ?? 0) / 60);
  const trades  = parseInt(w[`buy_${p}`] ?? (p==='30d'?w.buy:0) ?? 0) + parseInt(w[`sell_${p}`] ?? (p==='30d'?w.sell:0) ?? 0);
  return {pnl, winrate, holdMins, trades};
}
function parseEntry(w, period) {
  const addr = w.wallet_address || w.address; if (!addr) return null;
  const d = parsePeriodData(w, period);
  return {addr, ...d};
}
function mkWallet(addr, pnl, winrate, holdMins, trades, source, periods) {
  return { id:addr, address:addr, label:'', source, pnl, winrate, holdMins, trades,
    _periods: periods || null,
    tag: pnl>50000?'whale' : winrate>0.65?'smart' : trades>300?'bot' : '',
    lastActive: Date.now() };
}

// ‚îÄ‚îÄ Leaderboards ‚Üí wallets[] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function scrapeLeaderboards(minWr, minPnl, minTrades, seen) {
  // Always fetch all 6 endpoints (all 3 periods √ó PnL + WinRate)
  // Each leaderboard response contains all period fields, so we store all 3 at once
  const eps = [
    {url:'https://gmgn.ai/defi/quotation/v1/rank/sol/wallets/1d?orderby=pnl&direction=desc&limit=200',     label:'1d PnL',     period:'1d'},
    {url:'https://gmgn.ai/defi/quotation/v1/rank/sol/wallets/1d?orderby=winrate&direction=desc&limit=200', label:'1d WinRate', period:'1d'},
    {url:'https://gmgn.ai/defi/quotation/v1/rank/sol/wallets/7d?orderby=pnl&direction=desc&limit=200',     label:'7d PnL',     period:'7d'},
    {url:'https://gmgn.ai/defi/quotation/v1/rank/sol/wallets/7d?orderby=winrate&direction=desc&limit=200', label:'7d WinRate', period:'7d'},
    {url:'https://gmgn.ai/defi/quotation/v1/rank/sol/wallets/30d?orderby=pnl&direction=desc&limit=200',    label:'30d PnL',    period:'30d'},
    {url:'https://gmgn.ai/defi/quotation/v1/rank/sol/wallets/30d?orderby=winrate&direction=desc&limit=200',label:'30d WinRate',period:'30d'},
  ];
  let added = 0;
  for (let i=0; i<eps.length; i++) {
    const {url, label, period} = eps[i];
    try {
      log(`[Leaderboard] ${label}‚Ä¶`);
      const d = await pf(url);
      const list = d.data?.rank || d.rank || [];
      log(`[Leaderboard] ${label} ‚Äî ${list.length} entries`);
      for (const w of list) {
        const addr = w.wallet_address || w.address; if (!addr) continue;
        // Use the threshold period (currently selected) to decide whether to include
        const threshold = parsePeriodData(w, smartPeriod);
        if (threshold.winrate < minWr || threshold.pnl < minPnl || threshold.trades < minTrades) continue;
        if (seen.has(addr)) {
          // Already added ‚Äî update its period data with any new info from this endpoint
          const existing = wallets.find(ww => ww.address === addr);
          if (existing) {
            const pd = parsePeriodData(w, period);
            if (!existing._periods) existing._periods = {};
            existing._periods[period] = pd;
          }
          continue;
        }
        seen.add(addr);
        // Pre-store all 3 periods from this single response (all fields are present)
        const periods = {
          '1d':  parsePeriodData(w, '1d'),
          '7d':  parsePeriodData(w, '7d'),
          '30d': parsePeriodData(w, '30d'),
        };
        const active = periods[smartPeriod];
        wallets.unshift(mkWallet(addr, active.pnl, active.winrate, active.holdMins, active.trades, 'gmgn', periods));
        added++;
        log(`  ‚úì ${addr.slice(0,8)}‚Ä¶ $${Math.round(active.pnl).toLocaleString()} ${Math.round(active.winrate*100)}%WR`, 'ok');
      }
      save(); applyFilters(); badges();
      setProgress(5 + Math.round((i+1)/eps.length * 90));
      await sleep(650);
    } catch(e) { log(`[Leaderboard] ${label} failed: ${e.message}`, 'err'); }
  }
  return added;
}

// ‚îÄ‚îÄ Trending buyers ‚Üí trending[] (separate, no stats) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function scrapeTrendingWallets(seenTrend) {
  log('[Trending] Fetching hot tokens‚Ä¶', 'inf');
  let added = 0;
  try {
    const td = await pf('https://gmgn.ai/defi/quotation/v1/rank/sol/swaps/1h?orderby=swaps&direction=desc&limit=20');
    const tokens = (td.data?.rank||td.rank||[]).map(t=>t.address||t.token_address).filter(Boolean).slice(0,15);
    log(`[Trending] ${tokens.length} hot tokens`);
    for (let i=0; i<tokens.length; i++) {
      const tok = tokens[i];
      try {
        const bd = await pf(`https://gmgn.ai/defi/quotation/v1/tokens/top_buyers/sol/${tok}?limit=50&orderby=profit&direction=desc`);
        let buyers = bd.data?.holders ?? bd.holders ?? bd.data ?? [];
        if (!Array.isArray(buyers)) buyers = Object.values(buyers).find(v=>Array.isArray(v)) || [];
        for (const b of buyers) {
          const addr = b.wallet_address || b.address;
          if (!addr || seenTrend.has(addr)) continue;
          seenTrend.add(addr);
          const gmgnTags = [...(b.tags||[]),...(b.maker_token_tags||[])].filter(t=>typeof t==='string').slice(0,4);
          trending.push({address:addr, tokenCa:tok, tags:gmgnTags, addedAt:Date.now()});
          added++;
        }
        saveTrending(); renderTrending(); badges();
        await sleep(350);
      } catch(e) { log(`[Trending] ${tok.slice(0,8)}‚Ä¶ ${e.message}`, 'err'); }
    }
  } catch(e) { log(`[Trending] failed: ${e.message}`, 'err'); }
  log(`[Trending] Done ‚Äî ${added} addresses`, added>0?'ok':'inf');
  return added;
}

// ‚îÄ‚îÄ Main pipeline ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function startScrape() {
  if (scraping) return;
  scraping = true;
  const btn = document.getElementById('scrapeBtn');
  btn.disabled=true; btn.textContent='‚ü≥ Running‚Ä¶';
  document.getElementById('logPanel').innerHTML='';
  document.getElementById('logPanel').style.display='block';
  setStatus('Scraping‚Ä¶','running'); setProgress(2);

  const minWr     = (parseFloat(document.getElementById('cfgMinWr').value)    ||0)/100;
  const minPnl    =  parseFloat(document.getElementById('cfgMinPnl').value)   ||0;
  const minTrades =  parseInt(document.getElementById('cfgMinTrades').value)  ||0;
  const useGmgn   = document.getElementById('cfgGmgn').checked;
  const useTrend  = document.getElementById('cfgTrending').checked;

  try {
    let lb=0, tr=0;
    if (useGmgn) { const seen=new Set(wallets.map(w=>w.address)); lb=await scrapeLeaderboards(minWr,minPnl,minTrades,seen); }
    if (useTrend){ const seen=new Set(trending.map(w=>w.address)); tr=await scrapeTrendingWallets(seen); }
    save(); applyFilters(); setProgress(100); badges();
    setStatus(`Done ‚Äî ${lb} smart + ${tr} trending`,'done');
    log(`‚úì ${lb} smart money + ${tr} trending addresses`,'inf');
    toast(`‚úì ${lb} smart money wallets added`);
  } catch(e) { setStatus('Error','error'); log('Fatal: '+e.message,'err'); }

  scraping=false; btn.disabled=false; btn.textContent='‚ñ∂ Auto-Discover';
}

// ‚îÄ‚îÄ CA Lookup ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function caLookup() {
  const ca = document.getElementById('caInput').value.trim();
  if (!ca) return toast('Paste a contract address first');

  const btn    = document.getElementById('caBtn');
  const banner = document.getElementById('caBanner');
  btn.disabled=true; btn.innerHTML='<span class="spinning">‚óé</span> Fetching‚Ä¶';
  banner.style.display='none';
  caWallets=[]; renderCA(); badges();

  try {
    log(`[CA] ${ca.slice(0,8)}‚Ä¶`,'inf');
    const bd = await pf(`https://gmgn.ai/defi/quotation/v1/tokens/top_buyers/sol/${ca}?limit=100&orderby=profit&direction=desc`);
    let buyers = bd.data?.holders ?? bd.holders ?? bd.data ?? [];
    if (!Array.isArray(buyers)) buyers = Object.values(buyers).find(v=>Array.isArray(v)) || [];

    if (!buyers.length) {
      banner.className='ca-banner err';
      banner.textContent='No buyers found ‚Äî check the CA is correct and try again.';
      banner.style.display='block'; return;
    }

    log(`[CA] ${buyers.length} buyers ‚Äî fetching stats‚Ä¶`,'inf');

    for (let i=0; i<Math.min(buyers.length,100); i++) {
      const addr = buyers[i].wallet_address || buyers[i].address;
      if (!addr) continue;
      // Use null sentinels so we can distinguish "GMGN returned null" from "no data"
      const entry = {address:addr, tokenCa:ca, source:'ca', pnl:null, winrate:null, holdMins:null, trades:null, tag:'', hasStats:false, lastActive:Date.now()};
      try {
        // Fetch once with period=30d ‚Äî response includes all period fields (1d/7d/30d)
        const sd = await pf(`https://gmgn.ai/defi/quotation/v1/smartmoney/sol/walletNew/${addr}?period=30d`);
        const w = sd.data;
        if (w && typeof w === 'object') {
          // Pre-compute stats for all 3 periods from the single response
          const parsePeriod = (buyKey, sellKey, pnlKey) => {
            const pnl     = w[pnlKey] != null ? parseFloat(w[pnlKey]) : null;
            const winrate = w.winrate  != null ? parseFloat(w.winrate) : null; // same value regardless of period
            const holdMins= w.avg_holding_peroid != null ? Math.round(parseFloat(w.avg_holding_peroid)/60) : null;
            const trades  = parseInt(w[buyKey]??0) + parseInt(w[sellKey]??0) || null;
            return {pnl, winrate, holdMins, trades};
          };
          entry._periods = {
            '1d':  parsePeriod('buy_1d',  'sell_1d',  'realized_profit_1d'),
            '7d':  parsePeriod('buy_7d',  'sell_7d',  'realized_profit_7d'),
            '30d': parsePeriod('buy_30d', 'sell_30d', 'realized_profit_30d'),
          };
          // Apply the currently selected period
          const d = entry._periods[caPeriod];
          entry.pnl      = d.pnl;
          entry.winrate  = d.winrate;
          entry.holdMins = d.holdMins;
          entry.trades   = d.trades;
          entry.hasStats = d.pnl !== null;
          entry.tag = (d.pnl??0)>50000?'whale':(d.winrate??0)>0.65?'smart':(d.trades??0)>300?'bot':'';
        }
      } catch(_) {}
      caWallets.push(entry);
      if ((i+1)%5===0) { renderCA(); badges(); }
      await sleep(300);
    }

    const withFull    = caWallets.filter(w=>w.hasStats && w.winrate!==null).length;
    const withPartial = caWallets.filter(w=>w.hasStats && w.winrate===null).length;
    const addrOnly    = caWallets.filter(w=>!w.hasStats).length;
    banner.className='ca-banner';
    banner.textContent=`‚úì ${caWallets.length} wallets ¬∑ ${withFull} full stats ¬∑ ${withPartial} PnL+trades only ¬∑ ${addrOnly} address-only`;
    banner.style.display='block';
    renderCA(); badges();
    log(`[CA] Done ‚Äî ${caWallets.length} wallets, ${withFull+withPartial} with stats`,'ok');

  } catch(e) {
    banner.className='ca-banner err';
    banner.textContent='Error: '+e.message+' ‚Äî is server.py running?';
    banner.style.display='block';
    log(`[CA] failed: ${e.message}`,'err');
  }
  btn.disabled=false; btn.textContent='Fetch Traders';
}

function clearCA()       { caWallets=[]; renderCA(); badges(); document.getElementById('caBanner').style.display='none'; document.getElementById('caInput').value=''; }
function clearTrending() { if(!confirm('Clear all trending wallets?')) return; trending=[]; saveTrending(); renderTrending(); badges(); }

// ‚îÄ‚îÄ Smart money filter/sort ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleFilters() { document.getElementById('filterPanel').classList.toggle('open'); document.getElementById('filterBtn').classList.toggle('on'); }
function resetFilters() {
  ['fPnlMin','fPnlMax','fWrMin','fWrMax','fHoldMin','fHoldMax','fTradesMin','fTradesMax','fSearch'].forEach(id=>{const el=document.getElementById(id);if(el)el.value='';});
  document.getElementById('fTag').value=''; applyFilters();
}
function applyFilters() {
  const g=id=>document.getElementById(id)?.value.trim()||'';
  const num=id=>{const v=parseFloat(g(id).replace(/[$,%\s]/g,''));return isNaN(v)?null:v;};
  const search=g('fSearch').toLowerCase(), tagV=g('fTag');
  const pnlMin=num('fPnlMin'),pnlMax=num('fPnlMax'),wrMin=num('fWrMin'),wrMax=num('fWrMax');
  const holdMin=num('fHoldMin'),holdMax=num('fHoldMax'),tradesMin=num('fTradesMin'),tradesMax=num('fTradesMax');

  filtered=wallets.filter(w=>{
    if(search&&!w.address.toLowerCase().includes(search)&&!(w.label||'').toLowerCase().includes(search)) return false;
    if(tagV&&w.tag!==tagV) return false;
    if(pnlMin!==null&&w.pnl<pnlMin)         return false;
    if(pnlMax!==null&&w.pnl>pnlMax)         return false;
    if(wrMin!==null&&w.winrate*100<wrMin)    return false;
    if(wrMax!==null&&w.winrate*100>wrMax)    return false;
    if(holdMin!==null&&w.holdMins<holdMin)   return false;
    if(holdMax!==null&&w.holdMins>holdMax)   return false;
    if(tradesMin!==null&&w.trades<tradesMin) return false;
    if(tradesMax!==null&&w.trades>tradesMax) return false;
    return true;
  });

  const fv=({pnl:w=>w.pnl,winrate:w=>w.winrate,holdtime:w=>w.holdMins,trades:w=>w.trades})[sortField]||(w=>w.pnl);
  filtered.sort((a,b)=>sortAsc?fv(a)-fv(b):fv(b)-fv(a));

  const parts=[pnlMin!=null?`PnL‚â•$${pnlMin.toLocaleString()}`:'',pnlMax!=null?`PnL‚â§$${pnlMax.toLocaleString()}`:'',
    wrMin!=null?`WR‚â•${wrMin}%`:'',wrMax!=null?`WR‚â§${wrMax}%`:'',holdMin!=null?`Hold‚â•${holdMin}m`:'',
    holdMax!=null?`Hold‚â§${holdMax}m`:'',tradesMin!=null?`Trades‚â•${tradesMin}`:'',tradesMax!=null?`Trades‚â§${tradesMax}`:''].filter(Boolean);
  const sum=document.getElementById('filterSummary');
  if(sum) sum.textContent=parts.length?parts.join(' ¬∑ '):'No active filters';
  document.getElementById('filterDot')?.classList.toggle('on',parts.length>0);
  renderSmart();
}

function setSort(f) {
  if(sortField===f) sortAsc=!sortAsc; else{sortField=f;sortAsc=false;}
  const arr=sortAsc?'‚Üë':'‚Üì';
  const keys={pnl:'pnl',winrate:'wr',holdtime:'ht',trades:'tr'};
  ['pnl','winrate','holdtime','trades'].forEach(k=>{
    const on=k===f;
    document.getElementById('sb-'+k)?.classList.toggle('active',on);
    document.getElementById('th-'+k)?.classList.toggle('sorted',on);
    if(on){const key=keys[k];['a-','ta-'].forEach(p=>{const el=document.getElementById(p+key);if(el)el.textContent=arr;});}
  });
  applyFilters();
}

// ‚îÄ‚îÄ Shared wallet row HTML ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function wRowHTML(w, i, showDel) {
  const short=w.address.slice(0,5)+'‚Ä¶'+w.address.slice(-4);
  const hs=w.hasStats!==false;
  const pnl=w.pnl!=null?w.pnl:0;
  // winrate/hold/trades may be null if GMGN hasn't indexed this wallet
  const wrRaw=w.winrate; // null = GMGN returned null, not zero
  const wr=wrRaw!=null?Math.round(wrRaw*100):null;
  const hold=fmtHold(w.holdMins!=null?w.holdMins:0);
  const trades=w.trades!=null?w.trades:0;
  const hasWr=wr!==null, hasHold=w.holdMins!=null&&w.holdMins>0, hasTrades=w.trades!=null;
  const pnlStr=hs?(pnl>=0?'+$':'-$')+Math.abs(pnl).toLocaleString('en',{maximumFractionDigits:0}):'‚Äî';
  const pnlCls=pnl>=0?'pnl-p':'pnl-n';
  const wrCol=wr!=null?(wr>=60?'var(--green)':wr>=45?'var(--yellow)':'var(--red)'):'var(--dim)';
  const wrFill=wr!=null?(wr>=60?'#14f195':wr>=45?'#ffd166':'#f05c5c'):'#3d4f63';
  const tagEl=w.tag?`<span class="tag t-${w.tag}">${w.tag}</span>`:`<span style="color:var(--dim);font-size:10px">‚Äî</span>`;
  const statsEl=w.hasStats===undefined
    ? `<span style="font-family:var(--mono);font-size:11px;color:var(--muted)">${fmtDate(w.lastActive)}</span>`
    : w.hasStats
      ? `<span style="font-size:10px;color:var(--green);font-family:var(--mono)">‚úì full</span>`
      : `<span style="font-size:10px;color:var(--dim);font-family:var(--mono)">addr only</span>`;
  return `
    <div class="td td-num">${i+1}</div>
    <div class="td w-info">
      <span class="w-addr" onclick="cp('${w.address}')" title="Click to copy">${short}</span>
      <div class="w-meta"><span class="src-badge src-${w.source||'gmgn'}">${w.source||'gmgn'}</span>${w.label?`<span class="w-lbl">${esc(w.label)}</span>`:''}</div>
    </div>
    <div class="td">${tagEl}</div>
    <div class="td"><span class="${hs?pnlCls:''}" style="${!hs?'color:var(--dim)':''}">${pnlStr}</span></div>
    <div class="td wr-wrap">${hs&&hasWr?`<span class="wr-pct" style="color:${wrCol}">${wr}%</span><div class="wr-bar"><div class="wr-fill" style="width:${wr}%;background:${wrFill}"></div></div>`:`<span style="color:var(--dim);font-family:var(--mono);font-size:11px">‚Äî</span>`}</div>
    <div class="td hold-wrap"><span class="hold-v">${hs&&hasHold?hold.v:'‚Äî'}</span><span class="hold-u">${hs&&hasHold?hold.u:''}</span></div>
    <div class="td"><span class="trd">${hs&&hasTrades?trades.toLocaleString():'‚Äî'}</span></div>
    <div class="td">${statsEl}</div>
    <div class="td acts">
      <a class="btn-view" href="https://gmgn.ai/sol/address/${w.address}" target="_blank">GMGN ‚Üó</a>
      ${showDel?`<button class="btn-del" onclick="removeWallet('${w.id||w.address}')">‚úï</button>`:''}
    </div>`;
}

// ‚îÄ‚îÄ Render: smart ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderSmart() {
  const tbody=document.getElementById('tableBody'), empty=document.getElementById('emptyMsg');
  updateStats();
  document.getElementById('cBadge').textContent=`${filtered.length} wallet${filtered.length!==1?'s':''}`;
  if(!filtered.length){
    tbody.innerHTML=''; empty.style.display='block';
    empty.innerHTML=scraping
      ?'<div class="empty-icon" style="animation:pulse 1.2s infinite">‚óé</div><div class="empty-text">Discovering wallets‚Ä¶</div>'
      :'<div class="empty-icon">‚óé</div><div class="empty-text">No wallets yet.<br>Hit <b style="color:var(--green)">‚ñ∂ Auto-Discover</b> to start.</div>';
    return;
  }
  empty.style.display='none';
  const frag=document.createDocumentFragment();
  filtered.forEach((w,i)=>{const el=document.createElement('div');el.className='wrow col-sm';el.innerHTML=wRowHTML(w,i,true);frag.appendChild(el);});
  tbody.innerHTML=''; tbody.appendChild(frag);
}

// ‚îÄ‚îÄ Render: trending ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderTrending() {
  const tbody=document.getElementById('trendingBody'), empty=document.getElementById('trendingEmpty');
  const search=(document.getElementById('tSearch')?.value||'').toLowerCase();
  const list=trending.filter(w=>!search||w.address.toLowerCase().includes(search));
  document.getElementById('tBadge').textContent=list.length;
  if(!list.length){tbody.innerHTML='';empty.style.display='block';return;}
  empty.style.display='none';
  const frag=document.createDocumentFragment();
  list.slice(0,500).forEach((w,i)=>{
    const el=document.createElement('div');el.className='wrow col-tr';
    const short=w.address.slice(0,5)+'‚Ä¶'+w.address.slice(-4);
    const tokShort=w.tokenCa?w.tokenCa.slice(0,8)+'‚Ä¶':'‚Äî';
    const tagStr=w.tags?.length
      ?w.tags.map(t=>`<span style="font-size:10px;color:var(--muted);background:var(--surf2);border:1px solid var(--border);border-radius:3px;padding:1px 5px;margin-right:3px">${esc(t)}</span>`).join('')
      :`<span style="color:var(--dim);font-size:10px">‚Äî</span>`;
    el.innerHTML=`
      <div class="td td-num">${i+1}</div>
      <div class="td w-info">
        <span class="w-addr" onclick="cp('${w.address}')" title="Click to copy">${short}</span>
        <div class="w-meta"><span class="src-badge src-trending">trending</span></div>
      </div>
      <div class="td" style="font-family:var(--mono);font-size:11px;color:var(--blue)" title="${w.tokenCa}">${tokShort}</div>
      <div class="td">${tagStr}</div>
      <div class="td acts">
        <a class="btn-view" href="https://gmgn.ai/sol/address/${w.address}" target="_blank">GMGN ‚Üó</a>
        <button class="btn-del" onclick="removeTrending('${w.address}')">‚úï</button>
      </div>`;
    frag.appendChild(el);
  });
  tbody.innerHTML='';tbody.appendChild(frag);
}

// ‚îÄ‚îÄ Render: CA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderCA() {
  const tbody=document.getElementById('caBody'), empty=document.getElementById('caEmpty');
  const search=(document.getElementById('caSearch')?.value||'').toLowerCase();
  const tagV=document.getElementById('caTagF')?.value||'';
  const statsF=document.getElementById('caStatsF')?.value||'';
  const list=caWallets.filter(w=>{
    if(search&&!w.address.toLowerCase().includes(search)) return false;
    if(tagV&&w.tag!==tagV) return false;
    if(statsF==='yes'&&!w.hasStats) return false;
    if(statsF==='no'&&w.hasStats)  return false;
    return true;
  });
  document.getElementById('caBadge').textContent=list.length;
  if(!list.length){tbody.innerHTML='';empty.style.display='block';return;}
  empty.style.display='none';
  const frag=document.createDocumentFragment();
  list.forEach((w,i)=>{const el=document.createElement('div');el.className='wrow col-sm';el.innerHTML=wRowHTML(w,i,false);frag.appendChild(el);});
  tbody.innerHTML='';tbody.appendChild(frag);
}

// ‚îÄ‚îÄ Stats (smart money only) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateStats() {
  const list=filtered.length?filtered:wallets;
  document.getElementById('s-count').textContent=wallets.length;
  if(!list.length){['s-wr','s-pnl','s-hold','s-prof','s-shown'].forEach(id=>document.getElementById(id).textContent='‚Äî');return;}
  const avgWr=list.reduce((a,w)=>a+w.winrate,0)/list.length;
  const total=list.reduce((a,w)=>a+w.pnl,0);
  const avgH=list.reduce((a,w)=>a+w.holdMins,0)/list.length;
  const prof=list.filter(w=>w.pnl>0).length;
  document.getElementById('s-wr').textContent=Math.round(avgWr*100)+'%';
  const pe=document.getElementById('s-pnl');
  pe.textContent=(total>=0?'+$':'-$')+Math.abs(total).toLocaleString('en',{maximumFractionDigits:0});
  pe.className='stat-val '+(total>=0?'cv-green':'cv-red');
  const h=fmtHold(Math.round(avgH));
  document.getElementById('s-hold').textContent=h.v+' '+h.u;
  document.getElementById('s-prof').textContent=prof+' / '+list.length;
  document.getElementById('s-shown').textContent=filtered.length+' / '+wallets.length;
}

// ‚îÄ‚îÄ Utils ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function removeWallet(id)     {wallets=wallets.filter(w=>(w.id||w.address)!==id);save();applyFilters();badges();toast('Removed');}
function removeTrending(addr) {trending=trending.filter(w=>w.address!==addr);saveTrending();renderTrending();badges();toast('Removed');}
function clearAll()           {if(!confirm(`Remove all ${wallets.length} smart money wallets?`))return;wallets=[];save();applyFilters();badges();toast('Cleared');}
function fmtHold(m) {
  if(!m||m<1)return{v:'‚Äî',u:''};
  if(m<60)  return{v:m+'m',u:'minutes'};
  if(m<1440)return{v:(m/60).toFixed(1)+'h',u:'hours'};
  return         {v:(m/1440).toFixed(1)+'d',u:'days'};
}
function fmtDate(ts){const d=(Date.now()-ts)/86400000;if(d<1)return'today';if(d<2)return'1d ago';return Math.floor(d)+'d ago';}
function esc(s){return s.replace(/[<>&"]/g,c=>({'<':'&lt;','>':'&gt;','&':'&amp;','"':'&quot;'}[c]));}
function cp(addr){navigator.clipboard.writeText(addr).catch(()=>{});toast('Copied '+addr.slice(0,8)+'‚Ä¶');}

// ‚îÄ‚îÄ Boot ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
['solscope3','solscope4','solscope5','solscope6','solscope7','solscope8','solscope9','solscope10','solscope11','ss11','ss11t'].forEach(k=>localStorage.removeItem(k));
load(); setSmartPeriod(smartPeriod); setCAPeriod(caPeriod); applyFilters(); renderTrending(); badges();
</script>
</body>
</html>
